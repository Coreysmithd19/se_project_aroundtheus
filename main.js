!function(){"use strict";class e{constructor(e,t,r){let{name:s,link:o}=e;this._name=s,this._link=o,this._cardSelector=t,this._handleImageClick=r}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._cardEl.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeIcon()})),this._cardEl.querySelector(".card__trash-button").addEventListener("click",(()=>{this._handleDeleteCard()})),this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}_handleDeleteCard(){this._cardEl.remove(),this._cardEl=null}_handleLikeIcon(){this._cardEl.querySelector(".card__like-button").classList.toggle("card__like-button-active")}getView(){return this._cardEl=this._getTemplate(),this._cardEl.querySelector(".card__title").textContent=this._name,this._cardImageElement=this._cardEl.querySelector(".card__image"),this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,this._setEventListeners(),this._cardEl}}var t=class{constructor(e,t){this._config=e,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_toggleButtonState(e){this._hasInvalidInput(e)?this.disableButton():this._enableButton()}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._config.inputSelector)],this._submitButton=this._form.querySelector(this._config.submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState(this._inputEls)}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault(),this.disableButton()})),this._setEventListeners()}};class r{constructor(e){let{popupSelector:t}=e;this.popupElement=document.querySelector(t),this.openedModal=document.querySelector(".modal_opened"),this._handleEscClose=this._handleEscClose.bind(this)}open(){this.popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this.popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListners(){this.popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close-button"))&&this.close()}))}}class s extends r{constructor(e,t){super({popupSelector:e}),this.popupForm=this.popupElement.querySelector(".modal__form"),this.handleFormSubmit=t}_getInputValues(){const e=this.popupForm.querySelectorAll(".modal__form-input"),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListners(),this.popupForm.addEventListener("submit",(e=>{e.preventDefault(),this.handleFormSubmit(this._getInputValues()),e.target.reset(),super.close()}))}}const o={formSelector:".modal__form",inputSelector:".modal__form-input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__popup_input_type_error",errorClass:"modal__popup_error_visible"},i=document.querySelector("#profile__edit-button"),n=document.querySelector("#profile__edit-modal"),l=document.querySelector(".profile__title"),a=document.querySelector(".profile__description"),c=document.querySelector("#profile-title-input"),d=document.querySelector("#profile-description-input"),u=(n.querySelector("#modal-closed-button"),n.querySelector(".modal__form")),_=(document.querySelector("#card-template").content.firstElementChild,document.querySelector(".cards__list"),document.querySelector(".profile__add-button")),h=document.querySelector("#add-card-modal"),m=(h.querySelector("#modal-closed-button"),document.querySelector("#preview-image")),p=(document.querySelector(".modal__image"),m.querySelector("#modal-closed-button"),document.querySelector(".modal__title"),h.querySelector("#add-card-form")),E=(p.querySelector("#place-title"),p.querySelector("#place-image"),document.querySelector(".profile__image")),f=new class extends r{constructor(e){super({popupSelector:e}),this.previewImage=document.querySelector(".modal__imgae_popup"),this.previewImageTitle=document.querySelector(".modal__title")}open(e){this.previewImage.src=e.link,this.previewImage.alt=e.name,this.previewImageTitle.textContent=e.name,super.open()}}("#preview-image");function v(e){f.open({name:e.name,link:e.link})}function S(t){const r=function(t){return new e(t,"#card-template",v).getView()}(t);L.addItem(r)}f.setEventListners();const b=new s("#profile__edit-modal",(function(e){let{title:t,description:r}=e;q.profileEdit(t,r).then(((e,t)=>{g.setUserInfo(e,t)}))})),y=new s("#add-card-modal",(function(e){let{name:t,url:r}=e;S({name:t,link:r})})),g=new class{constructor(e,t,r){this._profiletitle=e,this._profiledescription=t,this._avatar=r}getUserInfo(){return{name:this._profiletitle.textContent,job:this._profiledescription.textContent,avatar:this._avatar.textContent}}setUserInfo(e,t,r){this._profiletitle.textContent=e,this._profiledescription.textContent=t,this._avatar.src=r}setAvatar(e){this._avatar.src=e}}(l,a,E),q=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ${res.status}"))).catch((e=>{console.error(e)}))}getUserInfo(){return fetch(`${this._baseUrl}/users`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ${res.status}"))).catch((e=>{console.error(e)}))}profileEdit(e){let{title:t,description:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:Json.stringify({title:t,description:r}).then((e=>e.ok?e.json():Promise.reject("Error: ${res.status}")))})}addCard(e,t){fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"6bc379b4-e2fd-4963-8b35-f48b85a38b35","Content-Type":"application/json"}});q.profileEdit(res).then((e=>{console.log(e)}));const C=new t(o,u),I=new t(o,p);C.enableValidation(),I.enableValidation(),b.setEventListeners(),y.setEventListeners(),i.addEventListener("click",(()=>{const e=g.getUserInfo();c.value=e.name,d.value=e.job,b.open()})),_.addEventListener("click",(()=>{y.open()}));const L=new class{constructor(e,t){let{renderer:r}=e;this._renderer=r,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:S},".cards__list");q.getInitialCards().then((e=>L.renderItems(e))),q.getUserInfo().then((e=>g.setUserInfo(e)))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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a0IsU0FBVSxLQUMzQzBHLEVBQWFuRCxNQUFNLElBS25CLE1BQU15QyxFQUFjLElJekhQLE1BQ1hsSCxXQUFBQSxDQUFXQyxFQUFhbUssR0FBbUIsSUFBL0IsU0FBQ0MsR0FBU3BLLEVBQ3BCSyxLQUFLZ0ssVUFBWUQsRUFDakIvSixLQUFLaUssV0FBYTNKLFNBQVNDLGNBQWN1SixFQUMzQyxDQUVBSSxXQUFBQSxDQUFZQyxHQUNWQSxFQUFNMUcsU0FBUzJHLElBQ2JwSyxLQUFLZ0ssVUFBVUksRUFBSyxHQUV4QixDQUVBdkQsT0FBQUEsQ0FBUXVELEdBQ05wSyxLQUFLaUssV0FBV0ksUUFBUUQsRUFDMUIsR0o0R0EsQ0FDRUwsU0FBVXZELEdBRVosZ0JBR0pTLEVBQUlzQixrQkFBa0JwQixNQUFNc0IsR0FBTzdCLEVBQVlzRCxZQUFZekIsS0FFM0R4QixFQUFJYSxjQUFjWCxNQUFNc0IsR0FBT3JCLEVBQVNDLFlBQVlvQixJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vQXJvdW5kIHRoZSBVUy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9Vc2VyaW5mby5qcyIsIndlYnBhY2s6Ly9Bcm91bmQgdGhlIFVTLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL0Fyb3VuZCB0aGUgVVMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gICAgY29uc3RydWN0b3IoeyBuYW1lLCBsaW5rIH0sIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaykge1xyXG4gICAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gICAgfVxyXG4gIFxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICB0aGlzLl9jYXJkRWxcclxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5faGFuZGxlTGlrZUljb24oKTtcclxuICAgICAgICB9KTtcclxuICBcclxuICAgICAgdGhpcy5fY2FyZEVsXHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2gtYnV0dG9uXCIpXHJcbiAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgXHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7bmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGlua30pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuICBcclxuICAgIF9oYW5kbGVEZWxldGVDYXJkKCkge1xyXG4gICAgICB0aGlzLl9jYXJkRWwucmVtb3ZlKCk7XHJcbiAgICAgIHRoaXMuX2NhcmRFbCA9IG51bGw7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBfaGFuZGxlTGlrZUljb24oKSB7XHJcbiAgICAgIHRoaXMuX2NhcmRFbFxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbi1hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBnZXRWaWV3KCkge1xyXG4gICAgICB0aGlzLl9jYXJkRWwgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICB0aGlzLl9jYXJkRWwucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsLnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpO1xyXG4gICAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fbmFtZTtcclxuICBcclxuICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgICAgcmV0dXJuIHRoaXMuX2NhcmRFbDtcclxuICAgIH1cclxuICB9IiwiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWwpIHtcclxuICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xyXG4gICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcclxuICAgICAgdGhpcy5fZm9ybSA9IGZvcm1FbDtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgICAgaWYoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KGlucHV0RWxzKSB7XHJcbiAgICByZXR1cm4gaW5wdXRFbHMuc29tZShpbnB1dEVsID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcbiAgXHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZShpbnB1dEVscykge1xyXG4gICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0RWxzKSkge1xyXG4gICAgICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgICAgIH1cclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcblxyXG4gIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICB0aGlzLl9pbnB1dEVscyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpXTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goaW5wdXRFbCA9PiB7XHJcbiAgICAgICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dEVscylcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcblxyXG4gIiwiIGV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHtwb3B1cFNlbGVjdG9yfSkge1xyXG4gICAgICAgIHRoaXMucG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKVxyXG4gICAgICAgIHRoaXMub3BlbmVkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbiAoKSB7XHJcbiAgICAgdGhpcy5wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UgKCkge1xyXG4gICAgICB0aGlzLnBvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlKGV2ZW50KSB7XHJcbiAgICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgXHJcbiAgICBzZXRFdmVudExpc3RuZXJzKCkge1xyXG4gICAgICB0aGlzLnBvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldmVudCkgPT4ge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikgfHxcclxuICAgICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCl7XHJcbiAgICAgICAgc3VwZXIoe3BvcHVwU2VsZWN0b3J9KVxyXG4gICAgICAgIHRoaXMucG9wdXBGb3JtID0gdGhpcy5wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKVxyXG4gICAgICAgIHRoaXMuaGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXRcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgY29uc3QgaW5wdXRMaXN0ID0gdGhpcy5wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fZm9ybS1pbnB1dFwiKTtcclxuICAgICAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcbiAgICAgICAgaW5wdXRMaXN0LmZvckVhY2goaW5wdXQgPT4ge1xyXG4gICAgICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBmb3JtVmFsdWVzO1xyXG4gICAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0bmVycygpO1xyXG4gICAgICAgIHRoaXMucG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIHRoaXMuaGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgICAgIGUudGFyZ2V0LnJlc2V0KCk7XHJcbiAgICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB9XHJcbiIsIiBleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gICAge1xyXG4gICAgbmFtZTpcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazpcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgbmFtZTpcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOlwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICBuYW1lOlwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6XCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgIG5hbWU6XCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOlwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgIG5hbWU6XCJOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOlwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgIG5hbWU6XCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazpcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICAgIH0sXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gICAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2Zvcm0taW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICAgIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9fcG9wdXBfaW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJtb2RhbF9fcG9wdXBfZXJyb3JfdmlzaWJsZVwiLFxyXG4gIH07IiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5cclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbVwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcblxyXG5cclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5cclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIlxyXG5cclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiXHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlcmluZm8uanNcIjtcclxuaW1wb3J0IHtpbml0aWFsQ2FyZHMsY29uZmlnfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCJcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuXHJcblxyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX2VkaXQtbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtY2xvc2VkLWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcclxuY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIilcclxuY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbkNsb3NlID0gYWRkQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtY2xvc2VkLWJ1dHRvblwiKTtcclxuY29uc3QgcHJldmlld0ltYWdlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctaW1hZ2VcIik7XHJcbmNvbnN0IHByZXZpZXdJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG5jb25zdCBwcmV2aWV3SW1hZ2VCdXR0b25DbG9zZSA9IHByZXZpZXdJbWFnZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtY2xvc2VkLWJ1dHRvblwiKTtcclxuY29uc3QgcHJldmlld0ltYWdlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX190aXRsZVwiKTtcclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xyXG5jb25zdCBjYXJkVGl0bGVJbnB1dCA9IGFkZENhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjcGxhY2UtdGl0bGVcIik7XHJcbmNvbnN0IGNhcmRVcmxJbnB1dCA9IGFkZENhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjcGxhY2UtaW1hZ2VcIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIilcclxuXHJcblxyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiAsIGhhbmRsZUltYWdlQ2xpY2spO1xyXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcclxufVxyXG5cclxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjcHJldmlldy1pbWFnZVwiKTtcclxuXHJcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdG5lcnMoKTtcclxuXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGRhdGEpIHtcclxuICBwb3B1cFdpdGhJbWFnZS5vcGVuKHsgbmFtZTogZGF0YS5uYW1lLCBsaW5rOiBkYXRhLmxpbmsgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmREYXRhKTtcclxuICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxufVxyXG5cclxuXHJcblxyXG5jb25zdCBwb3B1cFdpdGhFZGl0UHJvZmlsZUZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlX19lZGl0LW1vZGFsXCIsXHJcbiAgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXRcclxuKTtcclxuXHJcbmNvbnN0IG5ld0NhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI2FkZC1jYXJkLW1vZGFsXCIsXHJcbiAgaGFuZGxlTmV3Q2FyZFN1Ym1pdFxyXG4pO1xyXG5cclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVUaXRsZSwgcHJvZmlsZURlc2NyaXB0aW9uLCBwcm9maWxlSW1hZ2UpXHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI2YmMzNzliNC1lMmZkLTQ5NjMtOGIzNS1mNDhiODVhMzhiMzVcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTtcclxuXHJcbmFwaS5wcm9maWxlRWRpdChyZXMpIC50aGVuKChyZXMpID0+IHtcclxuICBjb25zb2xlLmxvZyhyZXMpO1xyXG59KTtcclxuXHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKCBjb25maWcsIHByb2ZpbGVFZGl0Rm9ybSApO1xyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoIGNvbmZpZywgYWRkQ2FyZEZvcm0gKTtcclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KHt0aXRsZSwgZGVzY3JpcHRpb24gfSl7XHJcbiAgYXBpLnByb2ZpbGVFZGl0KHRpdGxlLGRlc2NyaXB0aW9uKS50aGVuKCh0aXRsZSwgZGVzY3JpcHRpb24pID0+IHt1c2VySW5mby5zZXRVc2VySW5mbyh0aXRsZSxkZXNjcmlwdGlvbil9KTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZU5ld0NhcmRTdWJtaXQoeyBuYW1lLCB1cmwgfSkge1xyXG4gIHJlbmRlckNhcmQoeyBuYW1lLCBsaW5rOiB1cmwgfSwgY2FyZExpc3RFbCk7XHJcbn07XHJcblxyXG5wb3B1cFdpdGhFZGl0UHJvZmlsZUZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbm5ld0NhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuXHJcblxyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5qb2I7XHJcblxyXG4gIHBvcHVwV2l0aEVkaXRQcm9maWxlRm9ybS5vcGVuKCk7XHJcbn0pO1xyXG5cclxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCBcImNsaWNrXCIgLCAoKSA9PiB7XHJcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5cclxuXHJcbiAgY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgIHtcclxuICAgICAgcmVuZGVyZXI6IHJlbmRlckNhcmQsXHJcbiAgICB9LFxyXG4gICAgXCIuY2FyZHNfX2xpc3RcIik7XHJcblxyXG5cclxuYXBpLmdldEluaXRpYWxDYXJkcygpLnRoZW4oIHJlcyA9PiBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcyhyZXMpKTtcclxuXHJcbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oIHJlcyA9PiB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpKTsiLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcil7XHJcbiAgICAgICAgc3VwZXIoe3BvcHVwU2VsZWN0b3J9KVxyXG4gICAgICAgdGhpcy5wcmV2aWV3SW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWdhZV9wb3B1cFwiKTtcclxuICAgICAgIHRoaXMucHJldmlld0ltYWdlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX190aXRsZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKGRhdGEpIHtcclxuICAgICAgIHRoaXMucHJldmlld0ltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgICAgIHRoaXMucHJldmlld0ltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuICAgICAgIHRoaXMucHJldmlld0ltYWdlVGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB9XHJcblxyXG59XHJcbiAiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VyaW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcm9maWxldGl0bGUgLHByb2ZpbGVkZXNjcmlwdGlvbixwcm9maWxlSW1hZ2UpIHtcclxuICAgICAgICB0aGlzLl9wcm9maWxldGl0bGUgPSBwcm9maWxldGl0bGU7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZWRlc2NyaXB0aW9uID0gcHJvZmlsZWRlc2NyaXB0aW9uO1xyXG4gICAgICAgIHRoaXMuX2F2YXRhciA9IHByb2ZpbGVJbWFnZTtcclxuICAgIH07XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKXtcclxuICAgICAgICByZXR1cm57XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGV0aXRsZS50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgam9iOiB0aGlzLl9wcm9maWxlZGVzY3JpcHRpb24udGV4dENvbnRlbnQsXHJcbiAgICAgICAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyLnRleHRDb250ZW50XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyh0aXRsZSwgZGVzY3JpcHRpb24sIGF2YXRhcil7XHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZXRpdGxlLnRleHRDb250ZW50ID0gdGl0bGUsXHJcbiAgICAgICAgdGhpcy5fcHJvZmlsZWRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb24sXHJcbiAgICAgICAgdGhpcy5fYXZhdGFyLnNyYyA9IGF2YXRhcjtcclxuICAgIH07XHJcblxyXG4gICAgc2V0QXZhdGFyKG5ld0ltYWdlKSB7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyLnNyYyA9IG5ld0ltYWdlO1xyXG4gICAgfVxyXG5cclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHtiYXNlVXJsLCBoZWFkZXJzfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVyczs7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcblxyXG4gICAgICBoZWFkZXJzOiBcclxuICAgICAgICB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpOiBQcm9taXNlLnJlamVjdCgnRXJyb3I6ICR7cmVzLnN0YXR1c30nKSlcclxuIFxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbn0pO1xyXG4gICAgICBcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzYCwge1xyXG5cclxuICAgICAgaGVhZGVyczogXHJcbiAgICAgICAgdGhpcy5faGVhZGVyc1xyXG4gICAgICAsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKTogUHJvbWlzZS5yZWplY3QoJ0Vycm9yOiAke3Jlcy5zdGF0dXN9JykpXHJcbiBcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG59KTtcclxuICAgICAgXHJcbiAgfVxyXG5cclxuICBwcm9maWxlRWRpdCh7dGl0bGUsIGRlc2NyaXB0aW9ufSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCx7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKc29uLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgdGl0bGU6IHRpdGxlLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOmRlc2NyaXB0aW9uXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpOiBQcm9taXNlLnJlamVjdCgnRXJyb3I6ICR7cmVzLnN0YXR1c30nKSlcclxuICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG5cclxuXHJcbiBhZGRDYXJkKG5hbWUsIGxpbmspIHtcclxuICBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICBoZWFkZXJzOlxyXG4gICAgIHRoaXMuX2hlYWRlcnNcclxuICAsXHJcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIG5hbWUsXHJcbiAgICAgIGxpbmtcclxuICAgIH0pXHJcbiAgfSk7XHJcbiB9XHJcblxyXG5cclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHtyZW5kZXJlcn0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpOyBcclxuICAgIH1cclxuICBcclxuICAgIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcbiAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoaXRlbSk7XHJcbiAgICB9XHJcbiAgfSJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsIm5hbWUiLCJsaW5rIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRFbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlTGlrZUljb24iLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9jYXJkSW1hZ2VFbGVtZW50IiwicmVtb3ZlIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiZ2V0VmlldyIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiY29uZmlnIiwiZm9ybUVsIiwiX2NvbmZpZyIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZUVsIiwiaWQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImlucHV0RWxzIiwic29tZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImRpc2FibGVCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiX2lucHV0RWxzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwicG9wdXBFbGVtZW50Iiwib3BlbmVkTW9kYWwiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwia2V5Iiwic2V0RXZlbnRMaXN0bmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsInBvcHVwRm9ybSIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0TGlzdCIsImZvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJyZXNldCIsImZvcm1TZWxlY3RvciIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVUaXRsZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlRWRpdEZvcm0iLCJhZGROZXdDYXJkQnV0dG9uIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJhZGRDYXJkTW9kYWwiLCJwcmV2aWV3SW1hZ2VNb2RhbCIsImFkZENhcmRGb3JtIiwicHJvZmlsZUltYWdlIiwicG9wdXBXaXRoSW1hZ2UiLCJwcmV2aWV3SW1hZ2UiLCJwcmV2aWV3SW1hZ2VUaXRsZSIsImRhdGEiLCJyZW5kZXJDYXJkIiwiY2FyZERhdGEiLCJjYXJkRWxlbWVudCIsImdldENhcmRFbGVtZW50IiwiY2FyZFNlY3Rpb24iLCJhZGRJdGVtIiwicG9wdXBXaXRoRWRpdFByb2ZpbGVGb3JtIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImFwaSIsInByb2ZpbGVFZGl0IiwidGhlbiIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJuZXdDYXJkUG9wdXAiLCJfcmVmMiIsInVybCIsInByb2ZpbGV0aXRsZSIsInByb2ZpbGVkZXNjcmlwdGlvbiIsIl9wcm9maWxldGl0bGUiLCJfcHJvZmlsZWRlc2NyaXB0aW9uIiwiX2F2YXRhciIsImdldFVzZXJJbmZvIiwiam9iIiwiYXZhdGFyIiwic2V0QXZhdGFyIiwibmV3SW1hZ2UiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsIm1ldGhvZCIsImJvZHkiLCJKc29uIiwic3RyaW5naWZ5IiwiYWRkQ2FyZCIsIkpTT04iLCJhdXRob3JpemF0aW9uIiwibG9nIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsInVzZXJEYXRhIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW1zIiwiaXRlbSIsInByZXBlbmQiXSwic291cmNlUm9vdCI6IiJ9